+++
date = "2017-07-15T09:30:21+01:00"
title = "How to create a site like freshswift.net using Hugo, Travis CI, and GitHub Pages"
tags = [
    "hugo",
    "github",
    "travis",
    "swift"
]
categories = [
    "Hugo",
    "Travis",
    "GitHub",
    "Swift"
]

+++

I recently launched [freshswift.net](freshswift.net), a site of regularly updated, curated Swift links. I built it using Hugo, Travis CI, and GitHub Pages.

My goal in creating [freshswift.net](freshswift.net) was to create a site which I could easily update with new posts at any time from any device.

In this post I describe;

* The tools & services we need to create such a site
* The steps required to get a site up and running
* How we can easily update our site with new content

*Note: This post assumes that you are using a Mac, have basic knowledge of GitHub and continuous integration tools such as Travis CI (i.e you know what they are), and have experience using terminal on a Mac.*

---

## Tools and Services

### Hugo
[Hugo](https://gohugo.io) is an open source static website generator. What this means is that it builds (generates HTML) a website for us based on content and formatting we specify.

### Travis CI
[Travis CI](https://travis-ci.org) is a hosted continuous integration service which is used to build & distribute projects. Projects hosted on GitHub can be automatically built when they have been updated/changed.

### Github Pages
[GitHub Pages](https://pages.github.com) is a service from GitHub which allows us to host a website for our GitHub profile or any GitHub project repository.

---

## Getting up and running

### 1. Create a GitHub repository to host your site
Create a (free) GitHub account [here](https://github.com/join?source=header-home) if we don’t already have one. Now create a new public repository. This respository will host both the files we use to generate your site using Hugo, and the files generated by Hugo which will be your site’s files (Woah!).

### 2. Install Hugo
Install Hugo based on [this](https://gohugo.io/overview/installing/).

### 3. Create a basic site using Hugo
Following [this](https://gohugo.io/overview/quickstart/) guide, create a basic site (and optionally add a theme we like).

### 4. Push our Hugo files to our GitHub repository
Using [this](https://help.github.com/articles/adding-an-existing-project-to-github-using-the-command-line/) guide, push our Hugo content to our GitHub repository.

### 5. Create a GitHub Personal Access Token
As described in step 8 below, we need to provide Travis with a Personal Access Token. We can generate this token in your GitHub account settings. When we generate it, make sure the ``repo`` checkbox is ticked. This will give Travis the permissions it needs to push to our repository (again, more on this is in step 8 below).

### 6. Create a Travis CI account
Starting [here](https://travis-ci.com), create a Travis account by signing in to Travis with our GitHub account. When we create our Travis account, we grant Travis access to our GitHub account, which means Travis can access our GitHub repositories.

Travis is free for open source projects. The GitHub repository we created earlier to host your site is public, i.e your site is open source!

### 7. Configure Travis CI to generate our site
On our Travis profile page, we need to set Travis to build our Hugo GitHub repository.

In our case, this build will generate our site for us. Travis build configuration is done via a ``.travis.yml`` file. More information than you need right now can be found here. Basically, we need to add a ``.travis.yml`` file to our GitHub repository. We then add the information Travis needs to build our site.

Below are the relevant lines from the freshswift.net ``.travis.yml`` file, which specify how to build our Hugo site;

```
# Install the apt prerequisites
addons:
  apt:
    packages:
      - python-pygments
# Clean and don't fail
install:
  - rm -rf public || exit 0
# Build the website
script:
  - binaries/hugo --theme=fresh
```

### 8. Configure Travis CI to push our generated site to GitHub
Travis needs write-access to our GitHub repository. We provide this write access via a Travis environment variable which uses the the GitHub Personal Access Token we generated previously in step 5. Environment variables can be specified in the Travis repository setting. For our Personal Access Token, we create an environment variable named ``GITHUB_TOKEN``.

After Travis generates our site, we want to push the generated files to GitHub. Again, we configure this in the ``.travis.yml`` file, adding the following lines;

```
# Deploy to GitHub pages
deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  local_dir: public
  on:
    branch: master
```

What this actually does is;

* Specify that we want to host our site on GitHub pages

* Skip cleanup after a build because we don’t want to delete files the hugo files we use to generate our site

* Tell Travis to use our GitHub Personal Access Token environment variable

* Indicate that we want our generated site to be placed in a public directory

* Tell Travis to build the GitHub master branch

When Travis builds a GitHub pages project like ours, it automatically pushes the generated files to a branch named ``gh-pages``. If this branch does not yet exist, it creates it and then pushes the generated files to the branch.

### 9. Configure GitHub pages for our site repository
Now that we have our generated site files on a gh-pages branch in our GitHub repository, we need to configure GitHub pages to use this branch as the source of our site. We configure this in the Settings tab in our GitHub repository. In the Settings tab, find the GitHub Pages section, and select ‘gh-pages branch’ from the Source drop menu. 

Note this option will only be available if this branch already exists. The branch will exist if step 8 completed successfully (When Travis pushes the generated site to the gh-pages branch for the first time, the gh-pages branch will be created).

🎉 **That should be it!** Our site should now be up and running at ``https://ourUserName.github.io/ourProjectName``.

### * Optional - Setting up a custom domain name
In addition to using the GitHub pages address for our site, we can optionally use a custom domain name, such as freshswift.net. The steps here outline how we can do this. However, as our site is generated by Travis whenever we make a change, we need to do something a little special for the ‘Setting up a www subdomain’ step. As part of the travis build, we need to create the cname file, so it can be pushed to our gh-pages branch whenever our site is generated. We accomplish this by adding the following line to our .travis.yml file, right after the Hugo build step;

```
# Build the website
script:
  - binaries/hugo --theme=fresh
  # Create a CNAME file which maps our site to our custom domain
  - echo 'freshswift.net' > public/CNAME
```

Above we can see how the freshswift.net cname file is generated as part of the Travis build.

---

## Updating our site with new content
Hugo works by generating our site from content we specify in markdown files. Normally when we add new content, e.g a new blog post in a new markdown file, we need to manually re-generate the site using Hugo, and publish it. 

However…and this is the cool part…in our case all we need to do is create the markdown file and push it to our GitHub repository master branch.No need for us to re-generate our site manually using Hugo and push the generated site to GitHub, Travis takes care of this for us. Automation FTW!

Also, as GitHub allows us to to create and edit new files via it’s web interface, we can pretty much add new markdown (new site content) from any device.

---

## More information

* [freshswift.net](freshswift.net) is hosted publicly on GitHub, and so all files/code can be found here

* For [freshswift.net](freshswift.net) I actually created a simple iOS app which enables me to quickly create and push a new markdown file to GitHub, but it’s not something that’s required to gain the benefits of the approach described in this post

---

That’s it! 📱🚀👍🏽
